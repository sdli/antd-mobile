{"version":3,"sources":["../../api/lib/reqVerify.js"],"names":["config","require","pass","obj","Object","assign","result","msg","verifiedBody","passToRes","reqVerify","req","res","body","reqType","Type","parseInt","code","session","pngNum","Phone","PassWd","verifyCode","openid","module","exports"],"mappings":"AAAA,IAAIA,SAASC,QAAQ,aAAR,CAAb;AACA,IAAIC,OAAO,UAASC,GAAT,EAAa;AACpB,WAAOC,OAAOC,MAAP,CACH,EAACC,QAAQ,CAAT,EAAWC,KAAK,IAAhB,EADG,EAEH,EAACC,cAAaL,GAAd,EAFG,CAAP;AAIH,CALD;AAMA,IAAIM,YAAY,UAASN,GAAT,EAAa;AACzB,WAAOC,OAAOC,MAAP,CACH,EAACC,QAAQ,CAAC,CAAV,EAAYC,KAAI,SAAhB,EADG,EAEH,EAACC,cAAaL,GAAd,EAFG,CAAP;AAIH,CALD;;AAOA,IAAIO,YAAY,UAASC,GAAT,EAAaC,GAAb,EAAiB;AAC7B,QAAIC,OAAOF,IAAIE,IAAf;AACA,YAAQA,KAAKC,OAAb;AACI,aAAM,iBAAN;AACI,gBAAGD,KAAKE,IAAL,IAAa,CAAb,IAAkBC,SAASH,KAAKI,IAAd,KAAuBN,IAAIO,OAAJ,CAAYC,MAAxD,EAA+D;AAC3D,uBAAQ;AACJb,4BAAQ,CADJ;AAEJE,kCAAc;AACdO,8BAAM,CADQ;AAEdK,+BAAOP,KAAKO,KAFE;AAGdC,gCAAQR,KAAKQ;AAHC,qBAFV,EAAR;AAOH,aARD,MAQM,IAAGR,KAAKE,IAAL,IAAa,CAAhB,EAAkB;AAChB,uBAAOb,KAAK,EAACkB,OAAMP,KAAKO,KAAZ,EAAkBE,YAAWT,KAAKS,UAAlC,EAA6CP,MAAK,CAAlD,EAAL,CAAP;AACP;AACL,aAAM,eAAN;AACI,mBAAOb,KAAK,EAACkB,OAAMP,KAAKO,KAAZ,EAAkBL,MAAKF,KAAKE,IAA5B,EAAL,CAAP,CAdR,CAcwD;AACpD,aAAM,aAAN;AACI,mBAAQ,OAAOJ,IAAIO,OAAJ,CAAYK,MAAnB,KAA8B,WAA9B,IAA6CZ,IAAIO,OAAJ,CAAYK,MAAZ,IAAsB,EAApE,GAAwEd,UAAU,EAACc,QAAQ,CAAT,EAAV,CAAxE,GAA+Fd,UAAU,EAACc,QAAO,CAAR,EAAV,CAAtG;AACJ;AACI,mBAAOrB,MAAP;AAlBR;AAoBH,CAtBD;;AAwBAsB,OAAOC,OAAP,GAAiBf,SAAjB","file":"reqVerify.js","sourcesContent":["var config = require(\"./config.js\");\r\nvar pass = function(obj){\r\n    return Object.assign(\r\n        {result: 1,msg: \"通过\"},\r\n        {verifiedBody:obj}\r\n    );\r\n};\r\nvar passToRes = function(obj){\r\n    return Object.assign(\r\n        {result: -1,msg:\"返回给前端数据\"},\r\n        {verifiedBody:obj}\r\n    );\r\n}\r\n\r\nvar reqVerify = function(req,res){\r\n    var body = req.body;\r\n    switch (body.reqType){\r\n        case (\"TeacherLoginReq\"):\r\n            if(body.Type == 1 && parseInt(body.code) == req.session.pngNum){\r\n                return  {\r\n                    result: 1,\r\n                    verifiedBody: {\r\n                    Type: 1,\r\n                    Phone: body.Phone,\r\n                    PassWd: body.PassWd\r\n                }}\r\n            }else if(body.Type == 2){\r\n                    return pass({Phone:body.Phone,verifyCode:body.verifyCode,Type:2});\r\n            };\r\n        case (\"VerifyCodeReq\"):\r\n            return pass({Phone:body.Phone,Type:body.Type}); // 登录时type为2,注册为1，前端控制\r\n        case (\"checkOpenid\"):\r\n            return (typeof req.session.openid !== \"undefined\" && req.session.openid != \"\")?passToRes({openid: 1}):passToRes({openid:0});\r\n        default:\r\n            return pass();\r\n    }\r\n}\r\n\r\nmodule.exports = reqVerify;\r\n"]}